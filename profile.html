<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Your Profile - FlexMaster</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
      flex-wrap: wrap;
      gap: 16px;
    }

    .header-title {
      display: flex;
      align-items: center;
      gap: 12px;
      color: white;
    }

    .header-title h1 {
      font-size: 32px;
      font-weight: 700;
      text-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }

    .header-actions {
      display: flex;
      gap: 12px;
    }

    .btn {
      padding: 12px 24px;
      border-radius: 10px;
      text-decoration: none;
      font-weight: 600;
      transition: all 0.2s;
      border: none;
      cursor: pointer;
      font-size: 14px;
    }

    .btn-primary {
      background: white;
      color: #1e3c72;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(0,0,0,0.2);
    }

    .btn-secondary {
      background: rgba(255,255,255,0.2);
      color: white;
    }

    .btn-secondary:hover {
      background: rgba(255,255,255,0.3);
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .stat-card {
      background: white;
      padding: 24px;
      border-radius: 16px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.15);
    }

    .stat-card h3 {
      font-size: 14px;
      color: #666;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 12px;
      font-weight: 600;
    }

    .stat-number {
      font-size: 42px;
      font-weight: 700;
      color: #1e3c72;
      margin-bottom: 8px;
    }

    .stat-label {
      color: #999;
      font-size: 13px;
    }

    .level-section {
      background: white;
      padding: 32px;
      border-radius: 16px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.15);
      margin-bottom: 30px;
    }

    .level-section h2 {
      font-size: 24px;
      color: #333;
      margin-bottom: 24px;
      font-weight: 700;
    }

    .levels-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 16px;
    }

    .level-card {
      background: #f8f9fa;
      border: 2px solid #e0e0e0;
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      transition: all 0.3s;
      position: relative;
      overflow: hidden;
    }

    .level-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--color-start), var(--color-end));
    }

    .level-card.mobility { --color-start: #1976d2; --color-end: #42a5f5; }
    .level-card.activation { --color-start: #f57c00; --color-end: #ffb74d; }
    .level-card.stability { --color-start: #7b1fa2; --color-end: #ba68c8; }
    .level-card.power { --color-start: #c62828; --color-end: #ef5350; }
    .level-card.balance { --color-start: #2e7d32; --color-end: #66bb6a; }

    .level-icon {
      font-size: 32px;
      margin-bottom: 8px;
    }

    .level-type {
      font-size: 14px;
      font-weight: 600;
      color: #666;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 8px;
    }

    .level-number {
      font-size: 36px;
      font-weight: 700;
      color: #333;
      margin-bottom: 8px;
    }

    .level-progress {
      width: 100%;
      height: 8px;
      background: #e0e0e0;
      border-radius: 999px;
      overflow: hidden;
      margin-top: 12px;
    }

    .level-progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--color-start), var(--color-end));
      border-radius: 999px;
      transition: width 0.3s;
    }

    .level-xp {
      font-size: 12px;
      color: #999;
      margin-top: 6px;
    }

    .routines-header {
      background: white;
      padding: 20px 24px;
      border-radius: 16px 16px 0 0;
      border-bottom: 2px solid #e0e0e0;
    }

    .routines-header h2 {
      font-size: 24px;
      color: #333;
      font-weight: 700;
      margin: 0;
    }

    .routines-section {
      background: white;
      padding: 24px;
      border-radius: 0 0 16px 16px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.15);
    }

    .routine-list {
      list-style: none;
    }

    .routine-item {
      background: #f8f9fa;
      border: 2px solid #e0e0e0;
      border-radius: 12px;
      margin-bottom: 12px;
      transition: all 0.3s;
      overflow: hidden;
    }

    .routine-item:hover {
      border-color: #0066cc;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,102,204,0.1);
    }

    .routine-link {
      display: block;
      padding: 20px;
      text-decoration: none;
      color: inherit;
    }

    .routine-header {
      display: flex;
      justify-content: space-between;
      align-items: start;
      gap: 16px;
    }

    .routine-title {
      font-size: 18px;
      font-weight: 600;
      color: #0066cc;
      margin-bottom: 6px;
    }

    .routine-subtitle {
      font-size: 14px;
      color: #666;
      margin-bottom: 12px;
    }

    .routine-tags {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .tag {
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 12px;
      font-weight: 600;
    }

    .tag-category {
      background: #e3f2fd;
      color: #1976d2;
    }

    .tag-exercises {
      background: #f3e5f5;
      color: #7b1fa2;
    }

    .tag-time {
      background: #fff3e0;
      color: #f57c00;
    }

    .tag-xp {
      background: #e8f5e9;
      color: #2e7d32;
      font-weight: 700;
    }

    .routine-date {
      color: #999;
      font-size: 13px;
      white-space: nowrap;
    }

    .arrow {
      color: #0066cc;
      font-size: 24px;
      transition: transform 0.2s;
    }

    .routine-item:hover .arrow {
      transform: translateX(6px);
    }

    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: #999;
    }

    .empty-icon {
      font-size: 64px;
      margin-bottom: 16px;
      opacity: 0.5;
    }

    .empty-state h3 {
      font-size: 20px;
      color: #666;
      margin-bottom: 8px;
    }

    .empty-state p {
      margin-bottom: 24px;
    }

    @media (max-width: 768px) {
      .header {
        flex-direction: column;
        align-items: flex-start;
      }

      .levels-grid {
        grid-template-columns: 1fr;
      }

      .routine-header {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="header-title">
        <span style="font-size: 40px;"></span>
        <h1>Your Profile</h1>
      </div>
      <div class="header-actions">
        <a href="/" class="btn btn-primary">+ Create Routine</a>
        <a href="/logout" class="btn btn-secondary">Logout</a>
      </div>
    </div>

    <!-- Stats Overview -->
    <div class="stats-grid">
      <div class="stat-card">
        <h3>Total XP</h3>
        <div class="stat-number">{{ stats.total_xp }}</div>
        <div class="stat-label">Keep crushing it! ðŸ”¥</div>
      </div>
      <div class="stat-card">
        <h3>Routines Completed</h3>
        <div class="stat-number">{{ stats.total_routines }}</div>
        <div class="stat-label">Across {{ categories|length }} categories</div>
      </div>
      <div class="stat-card">
        <h3>Exercises Done</h3>
        <div class="stat-number">{{ stats.total_exercises }}</div>
        <div class="stat-label">That's dedication!</div>
      </div>
    </div>

    <!-- Movement Type Levels -->
    <div class="level-section">
      <h2>Your Movement Levels</h2>
      <div class="levels-grid">
        {% set movement_types = [
          ('mobility', 'ðŸŒŠ', 'Mobility'),
          ('activation', 'âš¡', 'Activation'),
          ('stability', 'ðŸ›ï¸', 'Stability'),
          ('power', 'ðŸ’¥', 'Power'),
          ('balance', 'âš–ï¸', 'Balance')
        ] %}
        
        {% for key, icon, label in movement_types %}
          {% set level = stats.levels[key] %}
          {% set current_xp = stats.movement_xp[key] %}
          {% set xp_for_level = (level ** 2) * 50 %}
          {% set xp_for_next = ((level + 1) ** 2) * 50 %}
          {% set xp_in_level = current_xp - xp_for_level %}
          {% set xp_needed = xp_for_next - xp_for_level %}
          {% set progress = (xp_in_level / xp_needed * 100) if xp_needed > 0 else 0 %}
          
          <div class="level-card {{ key }}">
            <div class="level-icon">{{ icon }}</div>
            <div class="level-type">{{ label }}</div>
            <div class="level-number">Level {{ level }}</div>
            <div class="level-progress">
              <div class="level-progress-fill" style="width: {{ progress }}%;"></div>
            </div>
            <div class="level-xp">
              {% if level == 0 %}
                {{ current_xp }} / {{ xp_for_next }} XP
              {% else %}
                {{ xp_in_level }} / {{ xp_needed }} XP
              {% endif %}
            </div>
          </div>
        {% endfor %}
      </div>
    </div>

    <!-- Routines Header -->
    <div class="routines-header">
      <h2>Your Routines</h2>
    </div>

    <!-- Routines List -->
    <div class="routines-section">
      {% if routines and routines|length > 0 %}
        <ul class="routine-list" id="routine-list">
          {% for routine in routines %}
            {% set data = routine.routine_json | fromjson %}
            {% set category = data.sport_category|default('Other') %}
            {% set total_time = data.warmups|sum(attribute='duration') if data.warmups else 0 %}
            {% set xp_earned = (data.warmups|length * 10) + 50 if data.warmups else 0 %}
            
            <li class="routine-item" data-category="{{ category|lower|replace(' ', '-') }}">
              <a href="/interactive/{{ routine.id }}" class="routine-link">
                <div class="routine-header">
                  <div style="flex: 1;">
                    <div class="routine-title">{{ data.exercise }} Warm-up</div>
                    <div class="routine-subtitle">Target: {{ data.muscle_groups }}</div>
                    <div class="routine-tags">
                      <span class="tag tag-category">{{ category }}</span>
                      {% if data.warmups %}
                        <span class="tag tag-exercises">{{ data.warmups|length }} exercises</span>
                        <span class="tag tag-time">{{ (total_time / 60)|round(1) }} min</span>
                      {% endif %}
                      <span class="tag tag-xp">+{{ xp_earned }} XP</span>
                    </div>
                  </div>
                  <div style="text-align: right;">
                    <div class="routine-date">{{ routine.created_at.split(' ')[0] }}</div>
                    <div class="arrow">â†’</div>
                  </div>
                </div>
              </a>
            </li>
          {% endfor %}
        </ul>
      {% else %}
        <div class="empty-state">
          <div class="empty-icon">ðŸ“‹</div>
          <h3>No routines yet</h3>
          <p>Start creating your personalized workout routines!</p>
          <a href="/" class="btn btn-primary">Create your first routine</a>
        </div>
      {% endif %}
    </div>
  </div>

  <script>
    // No filtering needed - showing all routines
  </script>
</body>
</html>